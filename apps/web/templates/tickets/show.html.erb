<div class="ticket">
  <h1 class="ticket-title">
    <%= ticket.title %>
  </h1>

  <div class="ticket-info">
    <span class="ticket-type type-<%= ticket.type %>"><%= t ticket.type %></span>
    <span class="ticket-priority priority-<%= ticket.priority %>"><%= t ticket.priority %></span>
    <span class="ticket-timestamp"><%= ticket.created_at %></span>
  </div>

  <% if authenticated and current_user.admin? and ticket.display_actions? %>
  <div class="ticket-actions">
    <button id="ticket-manage"><%= t 'manage' %></button>
  </div>
  <% end %>

  <div class="ticket-description">
    <%= ticket.description %>
  </div>

  <div class="ticket-actions">
    <% if actions.empty? %>
      <div class="info info-warn">
        <%= t 'no_actions' %>
      </div>
    <% else %>
      <ul class="ticket-action-list">
        <% actions.each do |a| %>
          <li class="action action-<%= a.type.to_s %>">
            <p class="msg"><%= a.msg %></p>
            <span class="date"><%= a.timestamp %></span>
            <% if a.comment %>
            <p class="comment"><%= a.comment %></p>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% end %>
  </div>
</div>

<% if authenticated and current_user.admin? and ticket.display_actions? %>
<div id="manage-form">
  <%= render template: 'tickets/manage' %>
</div>
<% end %>
